## Мультиагентная система доставки заказов

Выполнена в рамках курса "Разработка мультиагентных систем для управления
мобильными ресурсами на языке программирования Python"

Автор: студент группы 2-ИАИТ-114м Прыгунов Максим Иванович

2024 год. СамГТУ 

### Запуск программы:

Точка входу в программу находится по пути: `lab6/main.py`

Возможности программы:
- После удаления агента курьера из системы, его заказы перераспределяются между оставшимися агентами.
- После удаления агента заказа из системы, его курьер освобождается.
- При определении лучшего курьера, агент заказа учитывает расстояние, текущую загруженность курьера заказами, оставшееся место у него в рюкзаке - влезет заказ или нет.

### Структура программы:
- `agent_base.py` - базовый класс агента
- `courier_agent.py` - класс агента курьера
- `order_agent.py` - класс агента заказа
- `base_entity.py` - базовый класс сущности
- `courier_entity.py` - класс сущности курьера
- `order_entity.py` - класс сущности заказа
- `message.py` - класс сообщения для обмена между агентами
- `agent_dispatcher.py` - класс диспетчера агентов 
- `main.py` - точка входа в программу

### Пример работы программы:

![Пример работы программы](docs/img.png)

- После удаления агента `Русский Петр Васильевич` из системы, его заказ `Кастрюля` перераспределился на наиболее подходящего курьера `Моника Татьяна Владимировна`

### sequence диаграмма работы системы:
```mermaid
sequenceDiagram
    participant Заказ1
    participant Курьер1
    participant Курьер2
    participant Заказ2

    note over Заказ1: Формирование списка курьеров
    Заказ1 ->> Курьер1: Запрос параметров
    Заказ1 ->> Курьер2: Запрос параметров

    note over Заказ2: Формирование списка курьеров
    Заказ2 ->> Курьер1: Запрос параметров
    Заказ2 ->> Курьер2: Запрос параметров

    Курьер1 ->> Заказ1: Параметры: время, цена

    note over Заказ1: Все курьеры ответили? Нет, ожидаем всех ответов
    Курьер1 ->> Заказ2: Параметры: время, цена

    note over Заказ2: Все курьеры ответили? Нет, ожидаем все ответов
    Курьер2 ->> Заказ1: Параметры: время, цена

    note over Заказ1: Все курьеры ответили? Да, оцениваем варианты
    note over Заказ1: Выбор лучшего варианта

    Заказ1 ->> Курьер1: Прошу запланировать по варианту
    Курьер1 ->> Заказ1: Принято, вариант запланирован

    Курьер2 ->> Заказ2: Параметры: время, цена

    note over Заказ2: Все курьеры ответили? Да, оцениваем варианты
    note over Заказ2: Выбор лучшего варианта

    Заказ2 ->> Курьер1: Прошу запланировать по варианту
    Курьер1 ->> Заказ2: Отказ, вариант уже невыполним

    note over Заказ2: Выбор лучшего варианта
    Заказ2 ->> Курьер2: Прошу запланировать по варианту
    Курьер2 ->> Заказ2: Принято, вариант запланирован
```


### sequence диаграмма - выход с работы одного из агентов:
```mermaid
sequenceDiagram
    participant Заказ1
    participant Курьер1
    participant Курьер2
    participant Заказ2

    note over Заказ1: Формирование списка курьеров
    Заказ1 ->> Курьер1: Запрос параметров
    Заказ1 ->> Курьер2: Запрос параметров

    note over Заказ2: Формирование списка курьеров
    Заказ2 ->> Курьер1: Запрос параметров
    Заказ2 ->> Курьер2: Запрос параметров
    
    Курьер1 ->> Заказ1: Параметры: время, цена

    note over Заказ1: Все курьеры ответили? Нет, ожидаем всех ответов
    Курьер1 ->> Заказ2: Параметры: время, цена

    note over Заказ2: Все курьеры ответили? Нет, ожидаем всех ответов
    Курьер2 ->> Заказ1: Параметры: время, цена

    note over Заказ1: Все курьеры ответили? Да, оцениваем варианты
    note over Заказ1: Выбор лучшего варианта

    Заказ1 ->> Курьер1: Прошу запланировать по варианту
    Курьер1 ->> Заказ1: Принято, вариант запланирован
    
    Курьер2 ->> Заказ2: Параметры: время, цена

    note over Заказ2: Все курьеры ответили? Да, оцениваем варианты
    note over Заказ2: Выбор лучшего варианта

    Заказ2 ->> Курьер1: Прошу запланировать по варианту
    Курьер1 ->> Заказ2: Отказ, вариант уже невыполним

    note over Заказ2: Выбор лучшего варианта
    Заказ2 ->> Курьер2: Прошу запланировать по варианту
    Курьер2 ->> Заказ2: Принято, вариант запланирован

    note over Курьер1: Курьер уходит из работы
    Курьер1 ->> Заказ1: Сообщение об уходе из работы

    note over Заказ1: Смена исполнителя
    Заказ1 ->> Курьер2: Прошу запланировать по варианту
    Курьер2 ->> Заказ1: Принято, вариант запланирован
```
